name: üìä XMRT Ecosystem Activity Logging

on:
  push:
    branches: [ main ]
  issues:
    types: [opened, closed, edited, labeled]
  pull_request:
    types: [opened, closed, merged, edited]
  release:
    types: [published]
  schedule:
    # Log system status every hour
    - cron: '0 * * * *'
  workflow_dispatch:
    inputs:
      log_type:
        description: 'Type of logging to perform'
        required: true
        default: 'full'
        type: choice
        options:
        - full
        - system
        - activity
        - performance

permissions:
  contents: read
  issues: write
env:
  LOG_RETENTION_DAYS: 30

jobs:
  log-system-activity:
    name: üìä System Activity Logger
    runs-on: ubuntu-latest
    timeout-minutes: 10
    continue-on-error: true

    steps:
    - name: üì• Checkout Repository
      uses: actions/checkout@v4

    - name: üêç Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'

    - name: üîß Install Dependencies
      run: |
        python -m pip install --upgrade pip
try:
    # Only check if RENDER_API_KEY is available
    render_key = os.environ.get('RENDER_API_KEY')
    if render_key:
        dashboard_url = 'https://xmrt-ecosystem-xx5w.onrender.com/health'
except Exception as e:
    log_data['system_status'] = {'status': 'check_failed', 'error': str(e)[:100]}
    print(f'‚ö†Ô∏è System status check failed (non-critical): {e}')

# Log the activity (this always succeeds)